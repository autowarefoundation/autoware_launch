autoware_system_design_format: v0.1.0

name: Tier4PlanningWrapper.node

launch:
  package: tier4_planning_launch
  ros2_launch_file: planning.launch.xml

# interfaces
inputs:
  - name: lanelet_map
    message_type: autoware_map_msgs/msg/LaneletMapBin
  - name: occupancy_grid_map
    message_type: nav_msgs/msg/OccupancyGrid
  - name: traffic_signals
    message_type: tier4_perception_msgs/msg/TrafficLightGroupArray
  - name: objects
    message_type: autoware_perception_msgs/msg/PredictedObjects
  - name: obstacle_pointcloud
    message_type: sensor_msgs/msg/PointCloud2

outputs:
  - name: mission_planning/route
    message_type: autoware_planning_msgs/msg/LaneletRoute
  - name: trajectory
    message_type: autoware_planning_msgs/msg/Trajectory

# parameters
parameter_files: []

parameters:
  - name: enable_all_modules_auto_mode
    default: false
  - name: is_simulation
    default: false
  - name: use_sim_time
    default: false
  - name: vehicle_model
    default: sample_vehicle
  - name: behavior_path_planner_type
    default: behavior_path_planner
  - name: input_objects_topic_name
    default: ${input objects}
  - name: input_pointcloud_topic_name
    default: ${input obstacle_pointcloud}
  - name: pointcloud_container_name
    default: pointcloud_container

  # behavior path modules
  - name: launch_static_obstacle_avoidance
    default: true
  - name: launch_avoidance_by_lane_change_module
    default: true
  - name: launch_dynamic_obstacle_avoidance
    default: false
  - name: launch_sampling_planner_module
    default: false
  - name: launch_lane_change_right_module
    default: true
  - name: launch_lane_change_left_module
    default: true
  - name: launch_external_request_lane_change_right_module
    default: false
  - name: launch_external_request_lane_change_left_module
    default: false
  - name: launch_goal_planner_module
    default: true
  - name: launch_start_planner_module
    default: true
  - name: launch_side_shift_module
    default: true
  - name: launch_bidirectional_traffic_module
    default: true

  # behavior velocity modules
  - name: launch_crosswalk_module
    default: true
  - name: launch_walkway_module
    default: true
  - name: launch_traffic_light_module
    default: true
  - name: launch_intersection_module
    default: true
  - name: launch_roundabout_module
    default: false
  - name: launch_merge_from_private_module
    default: false
  - name: launch_blind_spot_module
    default: true
  - name: launch_detection_area_module
    default: true
  - name: launch_virtual_traffic_light_module
    default: true
  - name: launch_no_stopping_area_module
    default: true
  - name: launch_stop_line_module
    default: true
  - name: launch_occlusion_spot_module
    default: false
  - name: launch_speed_bump_module
    default: false
  - name: launch_no_drivable_lane_module
    default: false

  # motion planning modules
  - name: motion_path_smoother_type
    default: elastic_band
  - name: motion_path_planner_type
    default: path_optimizer

  # motion velocity planner modules
  - name: launch_obstacle_stop_module
    default: true
  - name: launch_obstacle_slow_down_module
    default: true
  - name: launch_obstacle_cruise_module
    default: true
  - name: launch_dynamic_obstacle_stop_module
    default: true
  - name: launch_out_of_lane_module
    default: true
  - name: launch_obstacle_velocity_limiter_module
    default: true
  - name: launch_run_out_module
    default: true
  - name: launch_boundary_departure_prevention_module
    default: true
  - name: launch_road_user_stop_module
    default: true

  - name: velocity_smoother_type
    default: JerkFiltered
  - name: launch_surround_obstacle_checker
    default: false

  # parking modules
  - name: launch_parking_module
    default: true

  # validator modules
  - name: launch_latency_checker
    default: true
  - name: launch_trajectory_checker
    default: true
  - name: launch_intersection_collision_checker
    default: true
  - name: launch_rear_collision_checker
    default: true

  # other modules
  - name: launch_remaining_distance_time_calculator
    default: true

  - name: mission_planner_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/mission_planning/mission_planner/mission_planner.param.yaml
  - name: behavior_path_planner_common_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/behavior_path_planner.param.yaml
  - name: behavior_path_planner_scene_module_manager_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/scene_module_manager.param.yaml
  - name: behavior_path_planner_side_shift_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/side_shift/side_shift.param.yaml
  - name: behavior_path_planner_static_obstacle_avoidance_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/autoware_behavior_path_static_obstacle_avoidance_module/static_obstacle_avoidance.param.yaml
  - name: behavior_path_planner_avoidance_by_lc_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/avoidance_by_lane_change/avoidance_by_lane_change.param.yaml
  - name: behavior_path_planner_sampling_planner_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/sampling_planner/sampling_planner.param.yaml
  - name: behavior_path_planner_dynamic_obstacle_avoidance_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/autoware_behavior_path_dynamic_obstacle_avoidance_module/dynamic_obstacle_avoidance.param.yaml
  - name: behavior_path_planner_lane_change_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/lane_change/lane_change.param.yaml
  - name: behavior_path_planner_goal_planner_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/goal_planner/goal_planner.param.yaml
  - name: behavior_path_planner_start_planner_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/start_planner/start_planner.param.yaml
  - name: behavior_path_bidirectional_traffic_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/autoware_behavior_path_bidirectional_traffic_module/bidirectional_traffic.param.yaml
  - name: behavior_path_planner_drivable_area_expansion_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_path_planner/drivable_area_expansion.param.yaml
  - name: path_generator_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/path_generator/path_generator.param.yaml
  - name: hazard_lights_selector_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/autoware_hazard_lights_selector/hazard_lights_selector.param.yaml
  - name: behavior_velocity_smoother_type_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/autoware_velocity_smoother/Analytical.param.yaml
  - name: behavior_velocity_planner_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/behavior_velocity_planner.param.yaml
  - name: behavior_velocity_planner_common_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/behavior_velocity_planner_common.param.yaml
  - name: behavior_velocity_planner_blind_spot_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/blind_spot.param.yaml
  - name: behavior_velocity_planner_crosswalk_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/crosswalk.param.yaml
  - name: behavior_velocity_planner_walkway_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/walkway.param.yaml
  - name: behavior_velocity_planner_detection_area_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/detection_area.param.yaml
  - name: behavior_velocity_planner_intersection_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/intersection.param.yaml
  - name: behavior_velocity_planner_stop_line_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/stop_line.param.yaml
  - name: behavior_velocity_planner_traffic_light_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/traffic_light.param.yaml
  - name: behavior_velocity_planner_virtual_traffic_light_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/virtual_traffic_light.param.yaml
  - name: behavior_velocity_planner_occlusion_spot_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/occlusion_spot.param.yaml
  - name: behavior_velocity_planner_roundabout_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/roundabout.param.yaml
  - name: behavior_velocity_planner_no_stopping_area_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/no_stopping_area.param.yaml
  - name: behavior_velocity_planner_speed_bump_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/speed_bump.param.yaml
  - name: behavior_velocity_planner_no_drivable_lane_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/behavior_planning/behavior_velocity_planner/no_drivable_lane.param.yaml
  - name: compare_map_filter_param_path
    default: $(find-pkg-share autoware_launch)/config/perception/object_recognition/detection/pointcloud_filter/pointcloud_map_filter.param.yaml
  - name: freespace_planner_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/parking/freespace_planner/freespace_planner.param.yaml
  - name: elastic_band_smoother_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/path_smoother/elastic_band_smoother.param.yaml
  - name: path_optimizer_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/autoware_path_optimizer/path_optimizer.param.yaml
  - name: path_sampler_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/path_sampler/path_sampler.param.yaml
  - name: surround_obstacle_checker_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/surround_obstacle_checker/surround_obstacle_checker.param.yaml
  - name: motion_velocity_planner_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/motion_velocity_planner.param.yaml
  - name: motion_velocity_planner_obstacle_stop_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/obstacle_stop.param.yaml
  - name: motion_velocity_planner_obstacle_slow_down_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/obstacle_slow_down.param.yaml
  - name: motion_velocity_planner_obstacle_cruise_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/obstacle_cruise.param.yaml
  - name: motion_velocity_planner_dynamic_obstacle_stop_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/dynamic_obstacle_stop.param.yaml
  - name: motion_velocity_planner_out_of_lane_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/out_of_lane.param.yaml
  - name: motion_velocity_planner_obstacle_velocity_limiter_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/obstacle_velocity_limiter.param.yaml
  - name: motion_velocity_planner_run_out_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/run_out.param.yaml
  - name: motion_velocity_planner_boundary_departure_prevention_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/boundary_departure_prevention.param.yaml
  - name: motion_velocity_planner_road_user_stop_module_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/lane_driving/motion_planning/motion_velocity_planner/road_user_stop.param.yaml
  - name: motion_velocity_planner_velocity_smoother_type_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/autoware_velocity_smoother/Analytical.param.yaml
  - name: planning_validator_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/planning_validator/planning_validator.param.yaml
  - name: planning_validator_latency_checker_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/planning_validator/latency_checker.param.yaml
  - name: planning_validator_trajectory_checker_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/planning_validator/trajectory_checker.param.yaml
  - name: planning_validator_intersection_collision_checker_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/planning_validator/intersection_collision_checker.param.yaml
  - name: planning_validator_rear_collision_checker_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/planning_validator/rear_collision_checker.param.yaml
  - name: common_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/common.param.yaml
  - name: nearest_search_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/nearest_search.param.yaml
  - name: costmap_generator_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/costmap_generator.param.yaml
  - name: velocity_smoother_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/autoware_velocity_smoother/velocity_smoother.param.yaml
  - name: velocity_smoother_type_param_path
    default: $(find-pkg-share autoware_launch)/config/planning/scenario_planning/common/autoware_velocity_smoother/JerkFiltered.param.yaml
  - name: vehicle_param_file
    default: $(find-pkg-share sample_vehicle_description)/config/vehicle_info.param.yaml

# processes
processes:
  - name: plan_path
    trigger_conditions:
      - and:
          - once: lanelet_map
          - on_input: objects
    outcomes: 
      - to_output: mission_planning/route

