autoware_system_design_format: v0.1.0

name: TrafficLightRecognitionDetectorFine.module

instances:
  - name: map_based_detector
    entity: TrafficLightMapBasedDetector.node
  - name: detection
    entity: TrafficLightFineDetector.node
  - name: classifier_car
    entity: TrafficLightClassifierCar.node
  - name: classifier_pedestrian
    entity: TrafficLightClassifierPedestrian.node
  - name: occlusion_predictor
    entity: TrafficLightOcclusionPredictor.node

external_interfaces:
  input:
    - name: vector_map
    - name: image
    - name: camera_info
    - name: route
    - name: pointcloud
  output:
    - name: classification/traffic_signals
    - name: detection/rois

connections:
  - from: input.vector_map
    to: map_based_detector.input.vector_map
  - from: input.route
    to: map_based_detector.input.route
  - from: input.camera_info
    to: map_based_detector.input.camera_info
  
  - from: input.image
    to: detection.input.image
  - from: map_based_detector.output.rough_rois
    to: detection.input.rough_rois
  - from: map_based_detector.output.expected_rois
    to: detection.input.expect_rois
  - from: detection.output.rois
    to: output.detection/rois

  - from: input.image
    to: classifier_car.input.image
  - from: detection.output.rois
    to: classifier_car.input.rois

  - from: input.image
    to: classifier_pedestrian.input.image
  - from: detection.output.rois
    to: classifier_pedestrian.input.rois

  - from: input.pointcloud
    to: occlusion_predictor.input.cloud
  - from: input.vector_map
    to: occlusion_predictor.input.vector_map
  - from: input.camera_info
    to: occlusion_predictor.input.camera_info
  - from: detection.output.rois
    to: occlusion_predictor.input.rois
  - from: classifier_car.output.traffic_signals
    to: occlusion_predictor.input.car/traffic_signals
  - from: classifier_pedestrian.output.traffic_signals
    to: occlusion_predictor.input.pedestrian/traffic_signals
  - from: occlusion_predictor.output.traffic_signals
    to: output.classification/traffic_signals
