autoware_system_design_format: v0.1.0

# node information
name: PointcloudToLaserscan.node

launch:
  package: pointcloud_to_laserscan
  plugin: pointcloud_to_laserscan::PointCloudToLaserScanNode
  executable: pointcloud_to_laserscan_node
  node_output: screen

# interface
inputs:
  - name: pointcloud
    message_type: sensor_msgs/msg/PointCloud2
    remap_target: "~/input/pointcloud"

outputs:
  - name: laserscan
    message_type: sensor_msgs/msg/LaserScan
    remap_target: "~/output/laserscan"
  - name: pointcloud
    message_type: sensor_msgs/msg/PointCloud2
    remap_target: "~/output/pointcloud"
  - name: ray
    message_type: visualization_msgs/msg/Marker
    remap_target: "~/output/ray"
  - name: stixel
    message_type: visualization_msgs/msg/MarkerArray
    remap_target: "~/output/stixel"

# parameters
parameter_files: []

parameters:
  - name: target_frame
    default: base_link
  - name: transform_tolerance
    default: 0.01
  - name: min_height
    default: 0.0
  - name: max_height
    default: 2.0
  - name: angle_min
    default: -3.141592 # -PI
  - name: angle_max
    default: 3.141592 # PI
  - name: angle_increment
    default: 0.00349065850 # radians = 0.2 degrees
  - name: scan_time
    default: 0.0
  - name: range_min
    default: 1.0
  - name: range_max
    default: 200.0
  - name: use_inf
    default: true
  - name: inf_epsilon
    default: 1.0
  - name: concurrency_level
    default: 1
    description: "The concurrency level for the pointcloud to laserscan conversion. 0: detect number of cores, 1: single thread, 2-n: n threads"

# processes
processes:
  - name: convert
    trigger_conditions:
      - and:
          - on_input: pointcloud
    outcomes:
      - to_output: laserscan
