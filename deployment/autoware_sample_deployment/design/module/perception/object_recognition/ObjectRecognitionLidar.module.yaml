autoware_system_design_format: v0.1.0

name: ObjectRecognitionLidar.module

instances:
  - name: detection
    entity: ObjectDetectionLidar.module
  - name: tracking
    entity: ObjectTrackingSingleChannel.module
  - name: prediction
    entity: ObjectPredictionMapBased.module

external_interfaces:
  input:
    # map
    - name: pointcloud_map
    - name: vector_map
    - name: service_pointcloud_map_diff
    # localization
    - name: kinematic_state
    # traffic lights
    - name: traffic_lights
    # lidar
    - name: obstacle_pointcloud
    - name: lidar_ml_objects
  output:
    - name: objects
    - name: map_filtered_obstacle_pointcloud

connections:
  # detection
  - from: input.pointcloud_map
    to: detection.input.pointcloud_map
  - from: input.vector_map
    to: detection.input.vector_map
  - from: input.service_pointcloud_map_diff
    to: detection.input.service_pointcloud_map_diff
  - from: input.kinematic_state
    to: detection.input.kinematic_state
  - from: input.obstacle_pointcloud
    to: detection.input.obstacle_pointcloud
  - from: input.lidar_ml_objects
    to: detection.input.lidar_ml_objects
  - from: detection.output.filtered_obstacle_pointcloud
    to: output.map_filtered_obstacle_pointcloud

  # tracking
  - from: detection.output.detected_objects
    to: tracking.input.detected_objects
  - from: tracking.output.objects
    to: detection.input.tracked_objects

  # prediction
  - from: tracking.output.objects
    to: prediction.input.tracked_objects
  - from: input.vector_map
    to: prediction.input.vector_map
  - from: input.traffic_lights
    to: prediction.input.traffic_lights
  - from: prediction.output.objects
    to: output.objects
