autoware_system_design_format: 0.1.0

name: sample_system_sensing.parameter_set

local_variables:
  - name: vehicle_length
    value: $(eval $(var vehicle_info.front_overhang) + $(var vehicle_info.wheel_base) + $(var vehicle_info.rear_overhang))
  - name: vehicle_width
    value: $(eval $(var vehicle_info.wheel_tread) + $(var vehicle_info.left_overhang) + $(var vehicle_info.right_overhang))
  - name: min_longitudinal_offset
    value: $(eval -$(var vehicle_info.rear_overhang))
  - name: max_longitudinal_offset
    value: $(eval $(var vehicle_info.front_overhang) + $(var vehicle_info.wheel_base))
  - name: min_lateral_offset
    value: $(eval -($(var vehicle_info.wheel_tread) / 2.0 + $(var vehicle_info.right_overhang)))
  - name: max_lateral_offset
    value: $(eval $(var vehicle_info.wheel_tread) / 2.0 + $(var vehicle_info.left_overhang))
  - name: min_height_offset
    value: 0.0
  - name: max_height_offset
    value: $(var vehicle_info.vehicle_height)
  - name: max_steer_angle
    value: $(var vehicle_info.max_steer_angle)
  - name: max_tire_cut_angle
    value: 0.838
  - name: wheel_half_width
    value: $(eval $(var vehicle_info.wheel_width) / 2.0)
  - name: d_center_to_corner
    value: $(eval sqrt(pow($(var wheel_half_width), 2) + pow($(var vehicle_info.wheel_radius), 2)))
  - name: angle_corner
    value: $(eval atan2($(var wheel_half_width), $(var vehicle_info.wheel_radius)))
  - name: wheel_max_lon_offset_from_center
    value: $(eval $(var d_center_to_corner) if $(var angle_corner) < $(var max_tire_cut_angle) else $(var d_center_to_corner) * cos($(var max_tire_cut_angle) - $(var angle_corner)))
  - name: wheel_max_lat_offset_from_center
    value: $(eval $(var d_center_to_corner) * sin($(var max_tire_cut_angle) + $(var angle_corner)))
  - name: wheels_min_longitudinal_offset
    value: $(eval $(var vehicle_info.wheel_base) - $(var wheel_max_lon_offset_from_center))
  - name: wheels_max_longitudinal_offset
    value: $(eval $(var vehicle_info.wheel_base) + $(var wheel_max_lon_offset_from_center))
  - name: wheels_min_lateral_offset
    value: $(eval -($(var vehicle_info.wheel_tread) / 2.0 + $(var wheel_max_lat_offset_from_center)))
  - name: wheels_max_lateral_offset
    value: $(eval $(var vehicle_info.wheel_tread) / 2.0 + $(var wheel_max_lat_offset_from_center))
  - name: wheels_min_height_offset
    value: 0.0
  - name: wheels_max_height_offset
    value: $(eval $(var vehicle_info.wheel_radius) * 2.2)

parameters:
  - node: /sensing/vehicle_velocity_converter
    parameter_files: []
    parameters:
      - name: use_sim_time
        value: false
  - node: /sensing/lidar/top/lidar
    parameter_files: []
    parameters:
      - name: sensor_model
        value: VLS128
      - name: return_mode
        value: SingleStrongest
      - name: max_range
        value: 250.0
      - name: min_range
        value: 0.5
      - name: frame_id
        value: velodyne_top
      - name: sensor_ip
        value: 192.168.1.201
      - name: host_ip
        value: 192.168.1.10
      - name: data_port
        value: 2368
      - name: scan_phase
        value: 300.0
      - name: cloud_min_angle
        value: 0
      - name: cloud_max_angle
        value: 360
      - name: udp_only
        value: false
      - name: use_sim_time
        value: false
  - node: /sensing/lidar/top/crop_box_filter_self
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var min_longitudinal_offset)
      - name: max_x
        value: $(var max_longitudinal_offset)
      - name: min_y
        value: $(var min_lateral_offset)
      - name: max_y
        value: $(var max_lateral_offset)
      - name: min_z
        value: $(var min_height_offset)
      - name: max_z
        value: $(var max_height_offset)
  - node: /sensing/lidar/top/crop_box_filter_wheels
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var wheels_min_longitudinal_offset)
      - name: max_x
        value: $(var wheels_max_longitudinal_offset)
      - name: min_y
        value: $(var wheels_min_lateral_offset)
      - name: max_y
        value: $(var wheels_max_lateral_offset)
      - name: min_z
        value: $(var wheels_min_height_offset)
      - name: max_z
        value: $(var wheels_max_height_offset)
  - node: /sensing/lidar/top/distortion_corrector_node
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/distortion_corrector_node.param.yaml
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
  - node: /sensing/lidar/top/ring_outlier_filter
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/ring_outlier_filter_node.param.yaml
  - node: /sensing/lidar/left/lidar
    parameter_files: []
    parameters:
      - name: sensor_model
        value: VLP16
      - name: return_mode
        value: SingleStrongest
      - name: max_range
        value: 5.0
      - name: min_range
        value: 0.4
      - name: frame_id
        value: velodyne_left
      - name: sensor_ip
        value: 192.168.1.202
      - name: host_ip
        value: 192.168.1.10
      - name: data_port
        value: 2369
      - name: scan_phase
        value: 180.0
      - name: cloud_min_angle
        value: 300
      - name: cloud_max_angle
        value: 60
      - name: udp_only
        value: false
      - name: use_sim_time
        value: false
      - name: calibration_file
        value: $(find-pkg-share nebula_velodyne_decoders)/calibration/VLP16.yaml
  - node: /sensing/lidar/left/crop_box_filter_self
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var min_longitudinal_offset)
      - name: max_x
        value: $(var max_longitudinal_offset)
      - name: min_y
        value: $(var min_lateral_offset)
      - name: max_y
        value: $(var max_lateral_offset)
      - name: min_z
        value: $(var min_height_offset)
      - name: max_z
        value: $(var max_height_offset)
  - node: /sensing/lidar/left/crop_box_filter_wheels
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var wheels_min_longitudinal_offset)
      - name: max_x
        value: $(var wheels_max_longitudinal_offset)
      - name: min_y
        value: $(var wheels_min_lateral_offset)
      - name: max_y
        value: $(var wheels_max_lateral_offset)
      - name: min_z
        value: $(var wheels_min_height_offset)
      - name: max_z
        value: $(var wheels_max_height_offset)
  - node: /sensing/lidar/left/distortion_corrector_node
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/distortion_corrector_node.param.yaml
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
  - node: /sensing/lidar/left/ring_outlier_filter
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/ring_outlier_filter_node.param.yaml
  - node: /sensing/lidar/right/lidar
    parameter_files: []
    parameters:
      - name: sensor_model
        value: VLP16
      - name: return_mode
        value: SingleStrongest
      - name: max_range
        value: 5.0
      - name: min_range
        value: 0.4
      - name: frame_id
        value: velodyne_right
      - name: sensor_ip
        value: 192.168.1.203
      - name: host_ip
        value: 192.168.1.10
      - name: data_port
        value: 2370
      - name: scan_phase
        value: 180.0
      - name: cloud_min_angle
        value: 300
      - name: cloud_max_angle
        value: 60
      - name: udp_only
        value: false
      - name: use_sim_time
        value: false
      - name: calibration_file
        value: $(find-pkg-share nebula_velodyne_decoders)/calibration/VLP16.yaml
  - node: /sensing/lidar/right/crop_box_filter_self
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var min_longitudinal_offset)
      - name: max_x
        value: $(var max_longitudinal_offset)
      - name: min_y
        value: $(var min_lateral_offset)
      - name: max_y
        value: $(var max_lateral_offset)
      - name: min_z
        value: $(var min_height_offset)
      - name: max_z
        value: $(var max_height_offset)
  - node: /sensing/lidar/right/crop_box_filter_wheels
    parameter_files: []
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
      - name: negative
        value: true
      - name: processing_time_threshold_sec
        value: 0.01
      - name: min_x
        value: $(var wheels_min_longitudinal_offset)
      - name: max_x
        value: $(var wheels_max_longitudinal_offset)
      - name: min_y
        value: $(var wheels_min_lateral_offset)
      - name: max_y
        value: $(var wheels_max_lateral_offset)
      - name: min_z
        value: $(var wheels_min_height_offset)
      - name: max_z
        value: $(var wheels_max_height_offset)
  - node: /sensing/lidar/right/distortion_corrector_node
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/distortion_corrector_node.param.yaml
    parameters:
      - name: input_frame
        value: base_link
      - name: output_frame
        value: base_link
      - name: use_sim_time
        value: false
  - node: /sensing/lidar/right/ring_outlier_filter
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/ring_outlier_filter_node.param.yaml
  - node: /sensing/lidar/concatenate_and_time_sync
    parameter_files:
      - param_file: $(find-pkg-share autoware_sample_deployment)/config/sensing/lidar/concatenate_and_time_sync_node.param.yaml
    parameters:
      - name: output_frame
        value: base_link
      - name: input_frame
        value: base_link
      - name: use_sim_time
        value: false
  - node: /sensing/imu/gyro_bias_estimator
    parameter_files:
      - imu_corrector_param_file: $(find-pkg-share sample_sensor_kit_description)/config/imu_corrector.param.yaml
    parameters:
      - name: use_sim_time
        value: false
  - node: /sensing/imu/imu_corrector
    parameter_files:
      - param_file: $(find-pkg-share sample_sensor_kit_description)/config/imu_corrector.param.yaml
    parameters:
      - name: use_sim_time
        value: false
